{
  "id": "azure-kusto-clusters-reference",
  "title": "Azure Kusto Clusters Reference - Troubleshooting & Log Analysis Guide",
  "body": "# Azure Kusto Clusters Reference - Troubleshooting & Log Analysis Guide\n\n## Overview\nComprehensive reference to 24 Azure Kusto (Azure Data Explorer) clusters across major Azure services. Essential for troubleshooting, log analysis, and operational insights across Azure infrastructure, applications, and services.\n\n**Source**: Extracted from kusto-connections*.json files (C:\\temp)\n**Total Clusters**: 24 clusters with 138 databases\n**Coverage**: Production Azure services, monitoring, and development environments\n\n## Quick Reference Stats\n- **Total Clusters**: 24 Kusto clusters\n- **Total Databases**: 138 databases \n- **Major Services**: Service Fabric, ARM, Batch, Storage, Networking, Security\n- **Cluster Types**: Engine (23), DataManagement (1)\n- **Authentication**: Federated authentication enabled (fed=true)\n\n## Clusters by Service Category\n\n### ðŸ—ï¸ Azure Infrastructure\nCore Azure platform and infrastructure services:\n\n#### Azure Core (azcore.centralus)\n- **Connection**: `https://azcore.centralus.kusto.windows.net/;fed=true`\n- **Databases**: 45 databases (largest cluster)\n- **Purpose**: Core Azure infrastructure telemetry and operations\n- **Key Databases**: acccvmtmgeneva, APDeployment, AppGWT, ArchiveBackend, ArchiveService\n- **Use Cases**: Platform-wide troubleshooting, capacity analysis, deployment tracking\n\n#### Azure Configuration Management (azurecm)\n- **Connection**: `https://azurecm.kusto.windows.net/;fed=true`\n- **Databases**: 1 database\n- **Purpose**: Azure configuration management and deployment\n- **Use Cases**: Configuration drift analysis, deployment validation\n\n#### Azure CM Central US (azurecm.centralus)\n- **Connection**: `https://azurecm.centralus.kusto.windows.net/;fed=true`\n- **Databases**: 1 database\n- **Purpose**: Regional configuration management\n- **Use Cases**: Region-specific configuration troubleshooting\n\n### ðŸ”§ Azure Resource Manager (ARM)\nResource management and deployment services:\n\n#### ARM Production (armprod)\n- **Connection**: `https://armprod.kusto.windows.net/;fed=true`\n- **Databases**: 7 databases\n- **Key Databases**: ARMProd, CosmosToKusto, deployments, DockerManticore, Jinmenju\n- **Purpose**: Resource deployment, management operations, template processing\n- **Use Cases**: Deployment failures, resource state issues, template debugging\n\n#### ARM Global East US (armprodgbl.eastus)\n- **Connection**: `https://armprodgbl.eastus.kusto.windows.net/;fed=true`\n- **Databases**: 1 database\n- **Purpose**: Global ARM operations in East US region\n- **Use Cases**: Cross-region deployment issues, global resource management\n\n#### ARM Production East US (armprodeus.eastus)\n- **Connection**: `https://armprodeus.eastus.kusto.windows.net/;fed=true`\n- **Databases**: 4 databases\n- **Purpose**: Regional ARM operations and telemetry\n- **Use Cases**: East US specific resource management issues\n\n### ðŸ§© Service Fabric\nService Fabric cluster management and operations:\n\n#### Service Fabric Logs (sflogs)\n- **Connection**: `https://sflogs.kusto.windows.net/;fed=true`\n- **Databases**: 5 databases\n- **Key Databases**: atlas, incidentlogs, ManagedClusters\n- **Purpose**: Service Fabric cluster telemetry, incident tracking\n- **Use Cases**: Cluster health issues, node failures, application deployment problems\n\n#### Service Fabric Ingestion (ingest-sflogs)\n- **Connection**: `https://ingest-sflogs.kusto.windows.net/;fed=true`\n- **Type**: DataManagement\n- **Databases**: 0 databases (ingestion endpoint)\n- **Purpose**: Log ingestion pipeline for Service Fabric\n- **Use Cases**: Data ingestion issues, pipeline troubleshooting\n\n### ðŸ—„ï¸ Storage Services\nAzure storage and data services:\n\n#### XStore (xstore)\n- **Connection**: `https://xstore.kusto.windows.net/;fed=true`\n- **Databases**: 5 databases\n- **Key Database**: xstore (2,865 tables, 959 functions)\n- **Purpose**: Azure Storage backend telemetry and operations\n- **Use Cases**: Storage performance issues, capacity planning, data integrity\n\n### ðŸ”„ Azure Batch\nBatch processing and compute services:\n\n#### Azure Batch (azurebatch)\n- **Connection**: `https://azurebatch.kusto.windows.net/;fed=true`\n- **Databases**: 1 database (155 tables, 130 functions)\n- **Purpose**: Batch job execution, pool management, task scheduling\n- **Use Cases**: Job failures, pool scaling issues, task execution problems\n\n### ðŸŒ Networking\nAzure networking and connectivity services:\n\n#### Azure Physical Network (azphynet)\n- **Connection**: `https://azphynet.kusto.windows.net/;fed=true`\n- **Databases**: 24 databases (second largest cluster)\n- **Key Databases**: azdhbackupmds, azdhmds, azdhsd, aznwmds, azphynetmds, AzureCM\n- **Purpose**: Physical network infrastructure, connectivity, performance\n- **Use Cases**: Network connectivity issues, performance degradation, routing problems\n\n#### Network Resource Provider (nrp)\n- **Connection**: `https://nrp.kusto.windows.net/;fed=true`\n- **Databases**: 2 databases\n- **Purpose**: Virtual network management, resource provisioning\n- **Use Cases**: VNet configuration issues, subnet problems, NSG troubleshooting\n\n### ðŸ“¦ Container Services\nContainer orchestration and management:\n\n#### Azure Container Registry Provider (azcrp)\n- **Connection**: `https://azcrp.kusto.windows.net/;fed=true`\n- **Databases**: 6 databases\n- **Purpose**: Container registry operations, image management\n- **Use Cases**: Image push/pull failures, registry authentication, storage issues\n\n### ðŸ”’ Security\nSecurity and identity services:\n\n#### U360 Security (u360sec)\n- **Connection**: `https://u360sec.kusto.windows.net/;fed=true`\n- **Databases**: 1 database (12 functions)\n- **Purpose**: Security monitoring, threat detection, compliance\n- **Use Cases**: Security incidents, compliance reporting, threat analysis\n\n### ðŸ“Š Monitoring & Analytics\nTelemetry, monitoring, and analytics services:\n\n#### Azure Traffic Manager Monitor (aztmmon)\n- **Connection**: `https://aztmmon.kusto.windows.net/;fed=true`\n- **Databases**: 7 databases\n- **Purpose**: Traffic Manager performance, routing decisions, health probes\n- **Use Cases**: Traffic routing issues, endpoint health problems, DNS resolution\n\n#### VM Insights (vmainsight)\n- **Connection**: `https://vmainsight.kusto.windows.net/;fed=true`\n- **Databases**: 11 databases\n- **Key Databases**: Air, AzureDCMDb, AzureGraph, BareMetal, CAD, Featurizer, vmaagent\n- **Purpose**: VM performance monitoring, insights, analytics\n- **Use Cases**: VM performance issues, capacity planning, health monitoring\n\n#### Azure Deployer Follower (azdeployerfollower.eastus)\n- **Connection**: `https://azdeployerfollower.eastus.kusto.windows.net/;fed=true`\n- **Databases**: 2 databases\n- **Key Database**: AzDeployerKusto (1,497 tables, 1,388 functions)\n- **Purpose**: Deployment tracking, rollout monitoring\n- **Use Cases**: Deployment failures, rollout analysis, change tracking\n\n### ðŸ”Œ API Management\nAPI gateway and management services:\n\n#### API Management (apim)\n- **Connection**: `https://apim.kusto.windows.net/;fed=true`\n- **Databases**: 2 databases\n- **Purpose**: API gateway telemetry, request/response tracking\n- **Use Cases**: API performance issues, throttling problems, authentication failures\n\n### ðŸ› ï¸ Development & Samples\nDevelopment tools and sample data:\n\n#### Help & Samples (help)\n- **Connection**: `https://help.kusto.windows.net/;fed=true`\n- **Databases**: 8 databases\n- **Key Databases**: ContosoSales, FindMyPartner, SampleIoTData, SampleLogs, Samples\n- **Purpose**: Learning, training, sample queries and datasets\n- **Use Cases**: Query development, training, proof of concepts\n\n#### One Engineering System (1es)\n- **Connection**: `https://1es.kusto.windows.net/;fed=true`\n- **Databases**: 1 database\n- **Purpose**: Engineering system telemetry, build and deployment\n- **Use Cases**: Build failures, deployment pipeline issues, engineering metrics\n\n### ðŸŽ§ Support & Operations\nCustomer support and operational services:\n\n#### Azure Customer Support (azcsup)\n- **Connection**: `https://azcsup.kusto.windows.net/;fed=true`\n- **Databases**: 1 database\n- **Purpose**: Customer support case tracking, resolution metrics\n- **Use Cases**: Support case analysis, escalation tracking, resolution patterns\n\n## Troubleshooting Usage Patterns\n\n### By Problem Category\n\n#### Application/Service Issues\n1. **Service Fabric Problems**: Query `sflogs` cluster databases\n2. **Batch Job Failures**: Analyze `azurebatch` cluster\n3. **API Gateway Issues**: Review `apim` cluster telemetry\n4. **Container Problems**: Check `azcrp` cluster data\n\n#### Infrastructure Issues\n1. **Networking Problems**: Start with `azphynet` for physical network, `nrp` for virtual networks\n2. **Storage Issues**: Query `xstore` cluster for storage backend problems\n3. **VM Performance**: Use `vmainsight` cluster for VM analytics\n4. **Regional Issues**: Check region-specific clusters (eastus, centralus)\n\n#### Deployment/Management Issues\n1. **ARM Template Failures**: Query `armprod*` clusters\n2. **Deployment Tracking**: Use `azdeployerfollower.eastus` for rollout analysis\n3. **Configuration Issues**: Check `azurecm*` clusters\n\n#### Security/Compliance Issues\n1. **Security Events**: Query `u360sec` cluster\n2. **Access Control**: Review ARM clusters for RBAC issues\n3. **Compliance Reporting**: Use security-focused databases\n\n### Common Query Patterns\n\n#### Basic Cluster Health\n```kusto\n// Check recent errors across tables\nTableName\n| where TimeGenerated >= ago(1h)\n| where Level == \"Error\"\n| summarize count() by bin(TimeGenerated, 5m)\n```\n\n#### Service-Specific Troubleshooting\n```kusto\n// Service Fabric cluster health (sflogs)\nClusterHealth\n| where TimeGenerated >= ago(4h)\n| where HealthState != \"Ok\"\n| project TimeGenerated, NodeName, HealthState, Description\n```\n\n```kusto\n// Batch job failures (azurebatch)\nBatchJobs\n| where TimeGenerated >= ago(1h)\n| where State == \"Failed\"\n| project TimeGenerated, JobId, TaskCount, FailureReason\n```\n\n#### Performance Analysis\n```kusto\n// Network performance (azphynet)\nNetworkMetrics\n| where TimeGenerated >= ago(2h)\n| summarize avg(Latency), max(PacketLoss) by bin(TimeGenerated, 10m), Region\n```\n\n## Integration with PowerShell\n\n### Connection Helper Functions\n```powershell\n# Quick connection to major clusters\nfunction Connect-ServiceFabricLogs {\n    $cluster = \"https://sflogs.kusto.windows.net/;fed=true\"\n    # Add Kusto client connection logic\n}\n\nfunction Connect-AzureBatchCluster {\n    $cluster = \"https://azurebatch.kusto.windows.net/;fed=true\"\n    # Add Kusto client connection logic\n}\n\nfunction Connect-ARMProdCluster {\n    $cluster = \"https://armprod.kusto.windows.net/;fed=true\"\n    # Add Kusto client connection logic\n}\n```\n\n### Cluster Discovery\n```powershell\n# Get all clusters by service category\n$clusters = @{\n    'ServiceFabric' = @('sflogs', 'ingest-sflogs')\n    'ARM' = @('armprod', 'armprodgbl.eastus', 'armprodeus.eastus')\n    'Batch' = @('azurebatch')\n    'Storage' = @('xstore')\n    'Networking' = @('azphynet', 'nrp')\n    'Security' = @('u360sec')\n    'Monitoring' = @('aztmmon', 'vmainsight', 'azdeployerfollower.eastus')\n}\n\nforeach ($category in $clusters.Keys) {\n    Write-Host \"$category clusters:\" -ForegroundColor Yellow\n    $clusters[$category] | ForEach-Object { Write-Host \"  $_\" }\n}\n```\n\n## Best Practices\n\n### Query Optimization\n1. **Time Range Filtering**: Always use `where TimeGenerated >= ago(timespan)` early in queries\n2. **Specific Tables**: Target specific tables rather than broad searches\n3. **Summarization**: Use `summarize` for aggregations rather than raw data\n4. **Indexing**: Leverage indexed columns for better performance\n\n### Troubleshooting Workflow\n1. **Identify Service**: Map the issue to the appropriate service category\n2. **Select Cluster**: Choose the relevant Kusto cluster from this reference\n3. **Time Correlation**: Use consistent time ranges across related queries\n4. **Cross-Cluster Analysis**: Compare data across related clusters for comprehensive view\n\n### Security Considerations\n1. **Federated Auth**: All clusters use Azure AD authentication (fed=true)\n2. **Access Control**: Cluster access controlled by Azure AD group membership\n3. **Data Classification**: Be aware of data sensitivity in different clusters\n4. **Query Logging**: All queries are logged and auditable\n\n## Maintenance Notes\n\n- **Cluster Topology**: Relatively stable, changes infrequently\n- **Database Schema**: Tables and functions change regularly, not included in this reference\n- **Regional Clusters**: Some services have region-specific clusters (eastus, centralus)\n- **Data Retention**: Varies by cluster and table, typically 30-90 days\n- **Performance**: Large clusters (azcore, azphynet) may have query throttling\n\nThis reference provides the essential cluster topology for Azure service troubleshooting without the performance overhead of full schema details. For current table schemas and functions, query the clusters directly using `.show tables` and `.show functions` commands.",
  "priority": 85,
  "audience": "all",
  "requirement": "recommended",
  "categories": [
    "azure-services",
    "kusto",
    "log-analysis",
    "monitoring",
    "reference",
    "troubleshooting"
  ],
  "sourceHash": "ef12ec4c20652fcad2e74d077d7b082d75424f927fefe4c5e58a1cbc77f18562",
  "schemaVersion": "3",
  "createdAt": "2025-09-01T14:30:33.559Z",
  "updatedAt": "2025-09-10T10:56:56.821Z",
  "riskScore": 35,
  "version": "1.0.0",
  "status": "approved",
  "owner": "unowned",
  "priorityTier": "P4",
  "classification": "internal",
  "lastReviewedAt": "2025-09-01T14:30:33.559Z",
  "nextReviewDue": "2025-12-30T14:30:33.559Z",
  "reviewIntervalDays": 120,
  "changeLog": [
    {
      "version": "1.0.0",
      "changedAt": "2025-09-01T14:30:33.559Z",
      "summary": "initial import"
    }
  ],
  "semanticSummary": "# Azure Kusto Clusters Reference - Troubleshooting & Log Analysis Guide",
  "primaryCategory": "azure-services"
}